"Codigo de Orion e Ulisses"






def precedencia(operatores):
    if operatores == '+':
        return 1
    elif operatores == ".":
        return 2
    elif operatores == "*":
        return 3
    else:
        return 0


def verificaParenteses(expressao):
    contParenteses = 0
    for i in range(0, len(expressao)):
        if expressao[i] == "(":
            contParenteses += 1
        elif expressao[i] == ")":
            contParenteses -= 1
    return contParenteses


def verificaVazia(entrada):
    if entrada == None or entrada == "":
        entrada = "&";
    return entrada

    expressao = "".join(x)
    return posicoes


def operandos(xar):
    TodosOperandos = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&'
    for i in range(0, len(TodosOperandos)):
        if xar == TodosOperandos[i]:
            valor = True
            return True
        else:
            valor = False
    return (valor)


def operadores(xar):
    TodosOperadores = '+*.'
    for i in range(0, len(TodosOperadores)):
        if xar == TodosOperadores[i]:
            valor = True
            return True
        else:
            valor = False
    return (valor)

class Automato(object):

    def __init__(self):
        self.alfabeto = None
        self.estados = Estados()
        self.estados = []
        self.qtEstados = None
        self.Transicoes = []
        self.estadoInicial = None
        self.estadosFinal = None


class Estados(object):

    def __init__(self):
        self.nome = 0


def baseF(simbolo):
    base = Automato()
    base.alfabeto = simbolo
    base.qtEstados = 2
    base.estados = [Estados()] * base.qtEstados
    base.estados[0] = Estados()
    base.estados[1] = Estados()
    base.estados[0].nome = 0
    base.estados[1].nome = 1
    base.Transicoes.append([simbolo, base.estados[0], base.estados[1]])
    base.estadoInicial = base.estados[0]
    base.estadosFinal = base.estados[1]
    return base


def uneAlfabetos(a, b):
    return a + b


def distibuiChars(lista, lista2):
    for i in range(0, len(lista)):
        lista2.append(lista[i])
    return lista2




def concatenacao(A, B):
    novo = Automato()
    novo.alfabeto = uneAlfabetos(A.alfabeto, B.alfabeto)
    novo.qtEstados = A.qtEstados + B.qtEstados

    for j in range(0, len(A.Transicoes)):
        novo.Transicoes.append([A.Transicoes[j][0], A.Transicoes[j][1], A.Transicoes[j][2]])

    for j in range(0, len(A.estados)):
        novo.estados.append(A.estados[j])

    for j in range(0, len(B.Transicoes)):
        novo.Transicoes.append([B.Transicoes[j][0], B.Transicoes[j][1], B.Transicoes[j][2]])

    for j in range(0, len(B.estados)):
        novo.estados.append(B.estados[j])

    novo.Transicoes.append(["&", A.estadosFinal, B.estadoInicial])

    novo.estadoInicial = novo.estados[0]
    novo.estadosFinal = novo.estados[-1]

    for i in range(0, len(novo.estados)):
        novo.estados[i].nome = i

    return novo


def uniao(A, B):
    novo = Automato()
    novo.alfabeto = uneAlfabetos(A.alfabeto, B.alfabeto)
    novo.qtEstados = A.qtEstados + B.qtEstados + 2
    newEstadoI = Estados()
    newEstadoF = Estados()

    novo.estados.append(newEstadoI)

    for j in range(0, len(A.Transicoes)):
        novo.Transicoes.append([A.Transicoes[j][0], A.Transicoes[j][1], A.Transicoes[j][2]])

    for j in range(0, len(A.estados)):
        novo.estados.append(A.estados[j])

    for j in range(0, len(B.Transicoes)):
        novo.Transicoes.append([B.Transicoes[j][0], B.Transicoes[j][1], B.Transicoes[j][2]])

    for j in range(0, len(B.estados)):
        novo.estados.append(B.estados[j])
    novo.estados.append(newEstadoF)

    novo.Transicoes.append(["&", novo.estados[0], A.estadoInicial])
    novo.Transicoes.append(["&", novo.estados[0], B.estadoInicial])
    novo.Transicoes.append(["&", A.estadosFinal, novo.estados[-1]])
    novo.Transicoes.append(["&", B.estadosFinal, novo.estados[-1]])

    novo.estadoInicial = novo.estados[0]
    novo.estadosFinal = novo.estados[-1]

    for i in range(0, len(novo.estados)):
        novo.estados[i].nome = i

    return novo



def fechoDeKleene(Ak):
    novo = Automato()
    novo.alfabeto = uneAlfabetos(Ak.alfabeto, "")
    novo.qtEstados = Ak.qtEstados + 2
    newEstadoI = Estados()
    newEstadoF = Estados()

    novo.estados.append(newEstadoI)

    for j in range(0, len(Ak.Transicoes)):
        novo.Transicoes.append([Ak.Transicoes[j][0], Ak.Transicoes[j][1], Ak.Transicoes[j][2]])

    for j in range(0, len(Ak.estados)):
        novo.estados.append(Ak.estados[j])

    novo.estados.append(newEstadoF)

    novo.Transicoes.append(["&", novo.estados[0], Ak.estadoInicial])
    novo.Transicoes.append(["&", novo.estados[0], novo.estados[-1]])
    novo.Transicoes.append(["&", Ak.estadoInicial, Ak.estadosFinal])
    novo.Transicoes.append(["&", Ak.estadosFinal, novo.estados[-1]])

    novo.estadoInicial = novo.estados[0]
    novo.estadosFinal = novo.estados[-1]

    for i in range(0, len(novo.estados)):
        novo.estados[i].nome = i

    return novo


def percorreExpressao(expressao):
    pilha = []
    for i in range(0, len(expressao)):
        if operandos(expressao[i]):
            pilha.append(baseF(expressao[i]))
        elif operadores(expressao[i]):
            if (expressao[i] == "*"):
                op1 = pilha.pop(-1)
                pilha.append(fechoDeKleene(op1))
            else:
                op2 = pilha.pop(-1)
                if pilha:
                    op1 = pilha.pop(-1)
                    if expressao[i] == ".":
                        pilha.append(concatenacao(op1, op2))
                    elif expressao[i] == "+":
                        pilha.append(uniao(op1, op2))
    return pilha


def olhaPilha(pilha):
    final = "\n-////////////////////////////////automato//////////////////////////////\n"
    for i in range(0, len(pilha[0].Transicoes)):
        final = final + str(pilha[0].Transicoes[i][0]) + "---------------------------->      " + str(
            pilha[0].Transicoes[i][1].nome) + "q<->q" + str(pilha[0].Transicoes[i][2].nome) + "\n"

    return final

def AFD(fechos, AFN):
    Fafn = []
    novo = Automato()
    novo.alfabeto = AFN[0].alfabeto

    for i in range(0, len(Fafn)):
        print("/////////////////////////")
        for j in range(0, len(Fafn[i])):
            print(Fafn[i][j].nome)


expressao="ab+*c."




print(olhaPilha(percorreExpressao(expressao)))
